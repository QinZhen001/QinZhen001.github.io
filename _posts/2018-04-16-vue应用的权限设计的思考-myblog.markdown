---
layout:     post
title:      "vue应用的权限设计的思考"
date:       2018-04-16 16:24:00
author:     "Qz"
header-img: "img/post-bg-2015.jpg"
catalog: true
tags:
    - Other
---

> “Yeah It's on. ”


## 正文
[网页链接](https://github.com/JesseZhao1990/blog/issues/64)

对于单页面应用来说，前端权限控制应该是从两个方面入手

1. 根据用户拥有的权限id的集合决定用户能访问那些前端路由
2. 根据用户拥有的权限id的集合决定用户能看到那些按钮或者模块。

### 完美的方案
在vue-router2.2之后的版本有个新的api叫addRouters，可以动态的添加路由。页面加载时的我们可以先初始化一个空路由，紧接着我们请求用户的权限信息，然后根本用户的权限信息筛选出来用户能访问的路由，然后利用addRouters添加到应用的路由中。

注意：当登录页在单页面之内时，并且登录页没有单独的路由时，按钮的权限过滤并不适合用指令，因为指令是依赖于指令所在的组件而生的，没法根据外部数据来决定指令所在的组件的有无。也就是说没法根据vuex中的数据来动态决定按钮的显示与否。当切换用户的时候，权限的list改变了，但是按钮并不会相应的更新，这时的最佳方法应该是把权限的鉴别功能封装成一个组件，而不是指令



















